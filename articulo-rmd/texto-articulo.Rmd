---
title: "Una mirada a los datos sobre la protesta social en Ecuador"
author: "Daniel Sánchez"
date: "Julio 2022"
bibliography: refs-article-protests.bib
csl: apa.csl
output: html_document
---

```{r setup, include = FALSE}
# Opciones de chunks

knitr::opts_chunk$set(echo = F, include = F)

# Cargar librerias

library(survey)
library(tidyverse)

# Cargar datos

load('../data/rdata/LAPOP 2004-2019 Manipulated Dataframe.Rdata')

# Realiza el survey design 2004-2019

lapop_des<-svydesign(ids = ~ upm, 
                     strata = ~ estratopri, 
                     weights = ~ weight1500, 
                     nest = TRUE,
                     na.action = 'na.exclude',
                     data = df)

# Definimos colores en HEX para los gráficos

quant_blue<-'#09A4CC'
quant_grey<-'#5C7C94'
quant_orange<-'#F8754D'
quant_red<-'#F44D54'

# Creamos un theme para ggplot2

theme_article_ds<-
  theme_bw() +
  theme(panel.grid = element_blank(),
        axis.text.y = element_blank(),
        plot.caption = element_text(hjust = 0, face = 'italic')) 

```

```{r grafico-participacion-protesta, include = T, echo = F, fig.align = 'center'}
## 1. Participación en protestas

# Debemos construir una sola variable en la base de datos que denote 1 si es que se participó en protest, 0 de otra forma

# De 2010 a 2019 se tiene prot3

# De 2006 a 2008 se tiene dos preguntas diferentes. 2004 no tiene pregunta sobre participación en protesta

# En el script de manipulación, he unificado las variables prot1, prot2 y prot3 en una sola (prot3)

# Por ende, tabulamos esa variable a lo largo del tiempo 

prot_time<-
  svyby(~ protest,
        ~ year,
        design = lapop_des,
        svymean,
        na.rm = T)

# Creamos una base de datos "tidy" para esto

prot_df<-
  prot_time %>%
  filter(protest > 0) %>% 
  as.data.frame()

rownames(prot_df)<-NULL

## 2. 

# Ahora si nuestro gráfico

ggplot(prot_df, aes(x = year, y = protest))+
  geom_col(fill = quant_blue,
           color = 'black', 
           width = 0.7)+
  geom_vline(xintercept = 0.5, linetype = 'dotted', color = quant_red, size = 1.25)+
  geom_vline(xintercept = 3.45, linetype = 'dotted', color = quant_red, size = 1.25)+
  geom_vline(xintercept = 5.55, linetype = 'dotted', color = quant_red, size = 1.25)+
  geom_vline(xintercept = 7.5, linetype = 'dotted', color = quant_red, size = 1.25)+
  geom_errorbar(aes(ymin = protest - 1.96*se,
                    ymax = protest + 1.96*se),
                width = 0.3)+
  geom_text(aes(label = round(protest, 4)*100),
                size = 3,
                vjust = 5)+
  labs(x = '',
       y = '% de personas mayores a 16 que han protestado',
       title = 'Participación en protestas del Ecuador 2006-2019',
       subtitle = '¿En los últimos 12 meses ha participado en una manifestación o protesta pública?',
       caption = 'Nota: Datos del Barómetro de las Américas. Barras representan intervalos de confianza al 95% con errores ajustados por\ndiseño muestral complejo. Líneas punteadas representan protestas de importancia en el país. Encuestas realizadas de \nenero a marzo de cada año salvo ronda 2016, realizada de nov. 2016 a ene. 2017. Las cifras representan el porcentaje de \npersonas que han protestado en los últimos 12 meses sobre el total de personas en edad de votar (mayores a 16).')+
  theme_article_ds+
  theme(axis.ticks = element_blank())
```
A mediados de junio 2022, la Confederación de Nacionalidades Indígenas del Ecuador (CONAIE) convocó a una movilización masiva en el país con el fin de que el programa de gobierno de Guillermo Lasso, elegido en abril 2021, incluya diez pedidos de índole económica y social [@Pazmino.2022]. Después de 18 días de manifestaciones, el paro terminó tras un acuerdo entre el gobierno nacional y la CONAIE, mediado por la iglesia católica mediante la Conferencia Episcopal [@GK.2022]. Las manifestaciones dejan al Ecuador con nueve muertos, millones de dólares en daños y pérdidas económicas así como varios heridos y aprehendidos por la policía [@Maria.2022;@Montalvo.2022;@Comercio.2022].

Desde 2019, el Ecuador parece haber perdido la relativa estabilidad política que tuvo durante los diez años de gobierno de Rafael Correa, puesto que desde octubre de ese año tomaría lugar una protesta histórica liderada una vez más por la CONAIE contra el gobierno del entonces presidente Lenín Moreno [@LAPOPReport.2022]. Sin embargo, el período de estabilidad ha sido más bien la excepción y no la norma, puesto que históricamente Ecuador ha tenido un golpe de estado cada 6 años, y un 50% de esos golpes de estado fueron exitosos derrocando al gobierno [@Loaiza.2022]. Dada la importancia de movilizaciones en el contexto político, social y económico del Ecuador y la renovada inestabilidad política, es imperante una mirada objetiva a las protestas y el contexto que las rodean desde un punto de vista cuantitativo, un punto de vista que logre informar a la discusión política post-paro. 

La encuesta del Barómetro de las Américas (AB) del Latin American Public Opinion Project (LAPOP) ha corrido rondas de encuestas de opinión publica en Ecuador desde el 2006, incluyendo algunas preguntas sobre protestas. La última vez que se realizaron preguntas sobre protestas fue a comienzos del 2019, lo que nos permite observar la opinión pública poco antes de la protesta de octubre 2019.

La participación en protestas decrece gradualmente en el país desde 2006 hasta principios del 2019. Comenzando con un significativo `r prot_df %>% filter(year == 2006) %>% select(protest) %>% round(4)*100`% de participación en protestas, probablemente por la participación en la "Rebelión de los Forajidos" que derrocó al Presidente Lucio Gutiérrez, el Ecuador comenzó el 2019 con un `r prot_df %>% filter(year == 2019) %>% select(protest) %>% round(4)*100`% de participación en protestas. En verano de 2015 se tuvo también movilizaciones de importancia convocadas por la CONAIE y políticos de la oposición contra el gobierno de Rafael Correa [@CONAIE.2015; @BBC.2015], sin embargo, las manifestaciones parecen no haber convocado tantas personas, aun cuando éstas coincidieron con la más baja popularidad del régimen del entonces presidente [@Melendez.2017]. Por otro lado, para 2019 se tiene un ligero pero estadísticamente significativo aumento en participación en protestas, aun cuando entre los períodos de encuesta no se registraron protestas a gran escala en el país. Considerando estos hechos y que en general en Ecuador quienes participan en protestas suelen ser una notable minoría (como es de esperarse, al ser un mecanismo que favorece a minorías que generalmente no cuentan con representación democrática suficiente), aparece la posibilidad de que el hecho de que exista una protesta a gran escala no necesariamente implica un aumento en la participación total en protestas. Es posible que se trate de la cantidad más que de la intensidad de protestas, ya que protestantes pueden no concentrarse en grandes manifestaciones sino en unas más pequeñas que reciben poca o ninguna atención de los medios.

```{r protestantes-carac}
# Realizamos tabulaciones cruzadas para observar características de los protestantes

# Base de solo protestantes

df_prot<-
  df %>% 
  filter(protest == 1)

# Diseño de encuesta

lapop_prot_des<-
  svydesign(ids = ~ upm, 
            strata = ~ estratopri, 
            weights = ~ weight1500, 
            nest = TRUE,
            na.action = 'na.exclude',
            data = df_prot)

# Edad promedio de protestante y no protestante

edad_protestante_promedio<-
  svyby(~ age,
        ~ protest,
        design = lapop_des,
        svymean,
        na.rm = T)

# Edad promedio de protestantes a lo largo del tiempo

edad_protestante_promedio_time<-
  svyby(~ age,
        ~ year,
        design = lapop_prot_des,
        svymean,
        na.rm = T)

# Distribución de género

genero_prot<-
    svyby(~ gndr,
          ~ protest,
          design = lapop_des,
          svymean,
          na.rm = T)

# Distribución de género a lo largo del tiempo

genero_prot_time<-
    svyby(~ gndr,
          ~ year,
          design = lapop_prot_des,
          svymean,
          na.rm = T)

# Años de educación promedio 

educacion_prot<-
    svyby(~ ed,
          ~ protest,
          design = lapop_des,
          svymean,
          na.rm = T)

# Años de educación promedio a lo largo del tiempo

educacion_prot_time<-
    svyby(~ ed,
          ~ year,
          design = lapop_prot_des,
          svymean,
          na.rm = T)

# Urbano-Rural

educacion_prot<-
    svyby(~ ed,
          ~ protest,
          design = lapop_des,
          svymean,
          na.rm = T)

# Para trabajar con identificación racial, creamos dos indicadores: indígenas y non-white/non-mestizo

# Indígenas

df$indg<-ifelse(df$etid == 3,1,0)

# Actualizamos el diseño muestral y la base de datos de protestantes

lapop_des<-svydesign(ids = ~ upm, 
                     strata = ~ estratopri, 
                     weights = ~ weight1500, 
                     nest = TRUE,
                     na.action = 'na.exclude',
                     data = df)
df_prot<-
  df %>% 
  filter(protest == 1)


lapop_prot_des<-
  svydesign(ids = ~ upm, 
            strata = ~ estratopri, 
            weights = ~ weight1500, 
            nest = TRUE,
            na.action = 'na.exclude',
            data = df_prot)

# Indígenas por protest

indg_prot<-
    svyby(~ indg,
          ~ protest,
          design = lapop_des,
          svymean,
          na.rm = T)

# Indígenas a lo largo del tiempo

indg_prot_time<-
    svyby(~ indg,
          ~ year,
          design = lapop_prot_des,
          svymean,
          na.rm = T)

# Distribución racial de la muestra

race_time<-
  svyby(~ as.factor(etid),
        ~ year,
        design = lapop_des,
        svymean,
        na.rm = T)

```

Ahora bien, ¿que caracteriza a los protestantes ecuatorianos? Tanto protestantes como no protestantes en promedio cercan los `r edad_protestante_promedio %>% filter(protest == 1) %>% select(age) %>% round(0)` años, siendo los protestantes marginalmente más jóvenes. Adicionalmente, a lo largo del tiempo los protestantes han sido mayoritariamente hombres, salvo en 2014 y 2019, en donde no existieron diferencias estadísticamente significativas entre ambos grupos. Quienes protestan tiene marginalmente más años de educación que aquellos que no, y dominan los protestantes de áreas urbanas, aunque esto puede deberse a que el muestreo de la encuesta se concentra mayormente en áreas urbanas. Un detalle clave sobre los protestantes es su composición racial: los datos de la encuesta permiten saber que existen diferencias estadísticamente significativas entre el porcentaje histórico de protestantes indígenas y no protestantes indígenas. De hecho, el porcentaje que representan los indígenas en los protestantes es cercano al 5% solamente. Esta cifra baja puede estar subestimada dado que no se realizan demasiadas encuestas en cantones rurales, donde la población indígena se concentra. Sin embargo, tiene sentido pensar que los manifestantes indígenas son una minoría sobre el total de todos los protestantes ya que actualmente la participación en protestas es un poco menor al 8% y la población indígena llega a alrededor del `r round((1.1/17.3)*100,2)`% de la población total del Ecuador en 2020 [@Ortiz.2020]. 

Viene al caso ahora considerar una diferencia clave que puede haber sido fácil de confundir en el Ecuador últimamente, especialmente mientras las protestas tomaban lugar: **la participación en protestas no es lo mismo que el apoyo a las mismas**. Salazar [-@Salazar.2022] cuantifica el apoyo a las protestas mediante la encuesta de opinión pública Latinobarómetro, encontrando que un 47% de entrevistados apoya a las protestas en general, y un 61% de quienes se autoidentifican como indígenas las apoyan también. El Barómetro de las Américas de LAPOP nos permite construir una serie de tiempo para monitorear el apoyo histórico a las protestas de los ecuatorianos, como se ve a continuación. 

```{r actitudes-protestas, include = T, fig.align = 'center'}
# Tabulamos la variable de apoyo a las protestas en general

# La variable toma valores de 1 al 10, siendo 10 que más apoyan las protestas en general. Escogemos a quienes responden 1-5
# como la gente que desaprueba el derecho a la protesta.

df$prot_desap<-ifelse(df$e5 > 5, 1, 0)

# Lo mismo con la variable de apoyo a las protestas de quienes hablan en contra del gobierno

df$prot_desap_op<-ifelse(df$d2 > 5, 1, 0)

# Actualizamos base de datos de protestantes y diseños muestrales

lapop_des<-
  svydesign(ids = ~ upm, 
            strata = ~ estratopri, 
            weights = ~ weight1500, 
            nest = TRUE,
            na.action = 'na.exclude',
            data = df)

df_prot<-
  df %>% 
  filter(protest == 1)

lapop_prot_des<-
  svydesign(ids = ~ upm, 
            strata = ~ estratopri, 
            weights = ~ weight1500, 
            nest = TRUE,
            na.action = 'na.exclude',
            data = df_prot)

# Hacemos la tabulación a nivel de año

desap_time<-
    svyby(~ prot_desap,
          ~ year,
          design = lapop_des,
          svymean,
          na.rm = T)

desap_op_time<-
    svyby(~ prot_desap_op,
          ~ year,
          design = lapop_des,
          svymean,
          na.rm = T)

# Juntar todo

desap_time_df<-
  desap_time %>%
  mutate(legend = 'Aprueba las protestas en general') %>% 
  bind_rows(desap_op_time %>% 
            rename(prot_desap = prot_desap_op) %>% 
            mutate(legend = 'Aprueba las protestas de grupos de oposición al gobierno' ))

rownames(desap_time_df)<-NULL

# Ahora si el gráfico

ggplot(desap_time_df, aes(x = year, y = prot_desap, color = legend, group = legend))+
  geom_line()+
  geom_line(aes(x = year, y = prot_desap - 1.96*se), color = quant_grey, linetype = 'dotted')+
  geom_line(aes(x = year, y = prot_desap + 1.96*se), color = quant_grey, linetype = 'dotted')+
  geom_point()+
  scale_color_manual(values = c('#964B00', quant_red),
                     breaks = c('Aprueba las protestas en general', 'Aprueba las protestas de grupos de oposición al gobierno'))+
  labs(x = '',
       y = '% de personas que aprueban protestas',
       title = 'Actitudes hacia protestas del Ecuador 2006-2019',
       subtitle = 'Porcentaje que aprueba el derecho a la protesta pacífica de diferentes grupos políticos',
       color = '',
       caption = 'Nota: Datos del Barómetro de las Américas. Barras representan intervalos de confianza al 95% con errores ajustados por\ndiseño muestral complejo. Encuestas realizadas de enero a marzo de cada año salvo ronda 2016, realizada de nov. 2016\na ene. 2017. Líneas punteadas en gris representan los límites inferiores y superiores del intervalo de confianza al 95%.\n Las cifras representan el porcentaje de personas que responden números mayores a 4 (del 1 al 10) sobre el total\nde personas en edad de votar (mayores a 16) del Ecuador.')+
  theme_article_ds+
  theme(legend.position = c(0.29,0.2),
        legend.background = element_blank(),
        axis.ticks.x = element_blank(),
        axis.text.y = element_text(size = 10))+
  scale_y_continuous(breaks = c(0.4,0.5,0.6,0.7), labels = c(40,50,60,70))
```

